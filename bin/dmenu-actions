#!/usr/bin/env bash

source "$( dirname "${BASH_SOURCE[0]}" )/.common.sh"

## Creates a dmenu prompt with actions

PRIVATE_ACTIONS="$( realpath ~/.dotfiles-private/actions )"
PUBLIC_ACTIONS="$( realpath ~/.dotfiles/more/actions )"

dmenu="$( realpath ~/.dotfiles/bin/dmenu )"

select_option() {
  "${dmenu}" -p "Action"
}

list_options() {
  ls ${PUBLIC_ACTIONS}
  ls ${PRIVATE_ACTIONS}
}

main() {
  local selected_action="$( list_options | sort -u | select_option )"

  if [ -z "${selected_action}" ]; then
    exit 0
  fi

  if [ -e "${PRIVATE_ACTIONS}/${selected_action}" ]; then
    "${PRIVATE_ACTIONS}/${selected_action}" 
  elif [ -e "${PUBLIC_ACTIONS}/${selected_action}" ]; then
    "${PUBLIC_ACTIONS}/${selected_action}" 
  fi
}

main
